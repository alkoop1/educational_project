# **ПРОЕКТ 7. ПРОГНОЗИРОВАНИЕ СТОИМОСТИ ЖИЛЬЯ**

## **Содержание**

1. [Описание проекта](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Описание-проекта)
2. [Проблематика](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Проблематика)
3. [Цели и задачи проекта](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Цели-и-задачи-проекта)
4. [Результаты EDA](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Результаты-EDA)
5. [Моделирование](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Моделирование)
    * 5.1 [Сравнение моделей](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Сравнение-моделей)
6. [Подготовка к созданию прототипа](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Подготовка-к-созданию-прототипа)
7. [Создание прототипа](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Создание-прототипа)
    * 7.1 [Инструкция по запуску](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Инструкция-по-запуску)
8. [Требования к окружению](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Требования-к-окружению)
9. [Заключение](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Заключение)
10. [Дополнительно](https://github.com/alkoop1/educational_project/tree/master/educational_projects/project_7/README.md#Дополнительно)

# **Описание проекта**

Этот проект посвящен разработке модели для предсказания стоимости жилья на основе истории предложений. Основная цель проекта — помочь агентству недвижимости обойти конкурентов по скорости и качеству проведения сделок за счёт автоматизации анализа объектов и оптимизации процесса оценки стоимости.

## **Проблематика**

Риелторам агентства требуется слишком много времени на сортировку объявлений и поиск наиболее выгодных предложений, что негативно сказывается на финансовых показателях. Это приводит к снижению конкурентоспособности агентства на рынке недвижимости.

## **Цели и задачи проекта**

- Провести детальный анализ данных (EDA) с использованием статистических тестов и визуализации, чтобы выявить основные факторы, влияющие на стоимость жилья.
- Провести предварительную обработку и очистку данных для повышения качества модели, включая удаление пропусков и выбросов, а также нормализацию данных.
- Разработать и протестировать различные модели прогнозирования стоимости жилья, чтобы определить наиболее точную и эффективную.
- Разработать сервис для интеграции модели в рабочий процесс агентства, обеспечивающий быстрые и точные предсказания, что позволит сократить время на анализ объявлений.

# **Результаты EDA**

В результате EDA мы проделали следующую работу:
- Избавились от пропусков, влияющих на целевую переменную, что повысило качество данных.
- Избавились от выбросов, чтобы улучшить стабильность и точность модели.
- Провели корреляционный анализ числовых признаков для выявления взаимосвязей между переменными.
- Посмотрели на распределение числовых признаков, в результате решили нормализовать и логарифмировать числовые признаки для улучшения работы моделей.
- Провели анализ номинативных переменных, чтобы понять их влияние на целевую переменную.
Сохраним обработанный датасет для дальнейшего использования при обучении модели.

# **Моделирование**

В данном разделе описаны шаги по созданию и тестированию различных моделей:
- Обработаны и отнормированы признаки для улучшения работы моделей.
- Построена "наивная" модель, предсказывающая цену по общей площади и городу, для сравнения с более сложными моделями.
- Построены модели с использованием LinearRegression, RandomForestRegressor, ElasticNetCV и CatBoostRegressor.
- На основе предыдущих шагов выбрана оптимальная модель, которая обеспечивает наилучшие результаты на тестовых данных.

## **Сравнение моделей**

| Metric       | NaiveModel | LinearRegression | RandomForestRegressor | ElasticNetCV | CatBoostRegressor |
|--------------|------------|------------------|-----------------------|--------------|-------------------|
| Train MSE    | 0.43       | 0.23             | 0.02                  | 0.23         | 0.10              |
| Test MSE     | 0.42       | 0.23             | 0.08                  | 0.23         | 0.11              |
| Train MAE    | 0.48       | 0.35             | 0.09                  | 0.35         | 0.23              |
| Test MAE     | 0.48       | 0.34             | 0.18                  | 0.34         | 0.23              |
| Train R2     | -0.01      | 0.45             | 0.96                  | 0.45         | 0.76              |
| Test R2      | -0.01      | 0.45             | 0.81                  | 0.45         | 0.74              |

На основе приведенных результатов, RandomForestRegressor кажется наилучшей моделью, так как она имеет наименьшие показатели ошибок MSE и MAE, а также высокий коэффициент детерминации (R²) на тестовых данных. Однако стоит учитывать возможность переобучения, так как разрыв между показателями на тренировочных и тестовых наборах является существенным. CatBoostRegressor также демонстрирует хорошие результаты и может считаться наилучшим выбором, если переобучение RandomForestRegressor является серьезной проблемой.

# **Подготовка к созданию прототипа**

- Подгружена обученная модель CatBoostRegressor для использования в прототипе.
- Написана функция для предсказания стоимости недвижимости по входным параметрам, обеспечивающая интеграцию модели в рабочий процесс.
- Проведен тест на воспроизводимость, чтобы убедиться в стабильности и надежности модели.

# **Создание прототипа**

- Создан Docker контейнер на основе образа `tiangolo/uwsgi-nginx-flask`, что упрощает развертывание сервиса.
- Расписана инструкция по созданию и запуску контейнера, обеспечивающая легкость использования для пользователей.

## **Инструкция по запуску**

1. Создайте Docker образ, следуя предоставленной инструкции.
2. Запустите сервер, используя команду из инструкции.
3. После запуска сервер будет доступен для обработки запросов.
4. Для тестирования предсказаний выполните команды, указанные в инструкции.

# **Требования к окружению**

Установка необходимых библиотек и зависимостей выполняется с помощью файла `requirements.txt`, что упрощает настройку окружения для работы с проектом.

# **Заключение**

На данном этапе мы имеем рабочий сервис с обученной моделью, способной предсказывать цену нового объекта недвижимости. Это позволяет агентству недвижимости значительно ускорить процесс оценки предложений и повысить конкурентоспособность на рынке.

# **Дополнительно**

Данные можно посмотреть и загрузить здесь [GoogleDisk](https://drive.google.com/drive/folders/1DAJ4cv7rEXkpN6SwBo8BfrH5db6eNJGC?usp=sharing)

Вы можете посмотреть работу в деле на [DockerHub](https://hub.docker.com/repository/docker/aleckkoop/final_project/general)